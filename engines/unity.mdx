---
title: "Unity Integration"
description: "Set up Wavedash for Unity WebGL builds"
---

This guide walks you through integrating Wavedash into your Unity project, from initial setup to publishing your WebGL game.

## Requirements

- Unity 6000+ recommended
- WebGL build support installed
- A Wavedash account and game created

## Project setup

### 1. Install the Wavedash CLI

<Tabs>
  <Tab title="macOS">
    ```bash
    brew install wvdsh/tap/wvdsh
    ```
  </Tab>
  <Tab title="Linux">
    ```bash
    curl --proto '=https' --tlsv1.2 -LsSf https://github.com/wvdsh/cli/releases/latest/download/wvdsh-installer.sh | sh
    ```
  </Tab>
  <Tab title="Windows">
    ```powershell
    irm https://github.com/wvdsh/cli/releases/latest/download/wvdsh-installer.ps1 | iex
    ```
  </Tab>
</Tabs>

### 2. Create wavedash.toml

In your Unity project root, create `wavedash.toml`:

```toml wavedash.toml
org_slug = "your-org"
game_slug = "your-game"
branch_slug = "production"
upload_dir = "./Build/WebGL"

[unity]
version = "6000.0.2f1"
```

<Note>
Set `upload_dir` to where your Unity WebGL build is saved.
</Note>

### 3. Configure WebGL build settings

1. Open **File > Build Settings**
2. Select **WebGL** and click **Switch Platform**
3. Configure **Player Settings** for WebGL:

**Recommended settings:**
- **Compression Format**: Gzip or Brotli
- **Memory Size**: 256 MB (adjust based on your game)
- **Exception Support**: None (for performance)
- **Publishing Settings > Decompression Fallback**: Enabled

## SDK integration

### JavaScript plugin

Create a JavaScript plugin to interface with the Wavedash SDK:

**Assets/Plugins/WebGL/WavedashPlugin.jslib:**

```javascript
mergeInto(LibraryManager.library, {
    WavedashIsReady: function() {
        return window.WavedashJS && WavedashJS.isReady();
    },

    WavedashGetUserId: function() {
        var userId = WavedashJS.getUserId();
        var bufferSize = lengthBytesUTF8(userId) + 1;
        var buffer = _malloc(bufferSize);
        stringToUTF8(userId, buffer, bufferSize);
        return buffer;
    },

    WavedashGetLeaderboard: function(namePtr, callbackObj, callbackMethod) {
        var name = UTF8ToString(namePtr);
        var obj = UTF8ToString(callbackObj);
        var method = UTF8ToString(callbackMethod);

        WavedashJS.getLeaderboard(name).then(function(response) {
            SendMessage(obj, method, JSON.stringify(response));
        });
    },

    WavedashUploadScore: function(leaderboardIdPtr, score, keepBest, callbackObj, callbackMethod) {
        var leaderboardId = UTF8ToString(leaderboardIdPtr);
        var obj = UTF8ToString(callbackObj);
        var method = UTF8ToString(callbackMethod);

        WavedashJS.uploadLeaderboardScore({
            leaderboardId: leaderboardId,
            score: score,
            keepBest: keepBest
        }).then(function(response) {
            SendMessage(obj, method, JSON.stringify(response));
        });
    },

    WavedashCreateLobby: function(visibilityPtr, maxPlayers, callbackObj, callbackMethod) {
        var visibility = UTF8ToString(visibilityPtr);
        var obj = UTF8ToString(callbackObj);
        var method = UTF8ToString(callbackMethod);

        WavedashJS.createLobby({
            visibility: visibility,
            maxPlayers: maxPlayers
        }).then(function(response) {
            SendMessage(obj, method, JSON.stringify(response));
        });
    },

    WavedashJoinLobby: function(lobbyIdPtr, callbackObj, callbackMethod) {
        var lobbyId = UTF8ToString(lobbyIdPtr);
        var obj = UTF8ToString(callbackObj);
        var method = UTF8ToString(callbackMethod);

        WavedashJS.joinLobby(lobbyId).then(function(response) {
            SendMessage(obj, method, JSON.stringify(response));
        });
    },

    WavedashSetStat: function(namePtr, value) {
        var name = UTF8ToString(namePtr);
        WavedashJS.setStat(name, value);
    },

    WavedashGetStat: function(namePtr) {
        var name = UTF8ToString(namePtr);
        return WavedashJS.getStat(name) || 0;
    }
});
```

### C# wrapper

Create a C# script to call the JavaScript functions:

**Assets/Scripts/WavedashSDK.cs:**

```csharp
using UnityEngine;
using System;
using System.Runtime.InteropServices;

public class WavedashSDK : MonoBehaviour
{
    public static WavedashSDK Instance { get; private set; }

    // Events
    public event Action<LeaderboardResponse> OnLeaderboardReceived;
    public event Action<ScoreResponse> OnScoreUploaded;
    public event Action<LobbyResponse> OnLobbyJoined;

    #if UNITY_WEBGL && !UNITY_EDITOR
    [DllImport("__Internal")]
    private static extern bool WavedashIsReady();

    [DllImport("__Internal")]
    private static extern string WavedashGetUserId();

    [DllImport("__Internal")]
    private static extern void WavedashGetLeaderboard(string name, string callbackObj, string callbackMethod);

    [DllImport("__Internal")]
    private static extern void WavedashUploadScore(string leaderboardId, int score, bool keepBest, string callbackObj, string callbackMethod);

    [DllImport("__Internal")]
    private static extern void WavedashCreateLobby(string visibility, int maxPlayers, string callbackObj, string callbackMethod);

    [DllImport("__Internal")]
    private static extern void WavedashJoinLobby(string lobbyId, string callbackObj, string callbackMethod);

    [DllImport("__Internal")]
    private static extern void WavedashSetStat(string name, float value);

    [DllImport("__Internal")]
    private static extern float WavedashGetStat(string name);
    #endif

    void Awake()
    {
        if (Instance == null)
        {
            Instance = this;
            DontDestroyOnLoad(gameObject);
        }
        else
        {
            Destroy(gameObject);
        }
    }

    public bool IsReady()
    {
        #if UNITY_WEBGL && !UNITY_EDITOR
        return WavedashIsReady();
        #else
        return false;
        #endif
    }

    public string GetUserId()
    {
        #if UNITY_WEBGL && !UNITY_EDITOR
        return WavedashGetUserId();
        #else
        return "";
        #endif
    }

    public void GetLeaderboard(string name)
    {
        #if UNITY_WEBGL && !UNITY_EDITOR
        WavedashGetLeaderboard(name, gameObject.name, "OnLeaderboardCallback");
        #endif
    }

    public void UploadScore(string leaderboardId, int score, bool keepBest = true)
    {
        #if UNITY_WEBGL && !UNITY_EDITOR
        WavedashUploadScore(leaderboardId, score, keepBest, gameObject.name, "OnScoreCallback");
        #endif
    }

    public void CreateLobby(string visibility = "public", int maxPlayers = 4)
    {
        #if UNITY_WEBGL && !UNITY_EDITOR
        WavedashCreateLobby(visibility, maxPlayers, gameObject.name, "OnLobbyCallback");
        #endif
    }

    public void JoinLobby(string lobbyId)
    {
        #if UNITY_WEBGL && !UNITY_EDITOR
        WavedashJoinLobby(lobbyId, gameObject.name, "OnLobbyCallback");
        #endif
    }

    public void SetStat(string name, float value)
    {
        #if UNITY_WEBGL && !UNITY_EDITOR
        WavedashSetStat(name, value);
        #endif
    }

    public float GetStat(string name)
    {
        #if UNITY_WEBGL && !UNITY_EDITOR
        return WavedashGetStat(name);
        #else
        return 0;
        #endif
    }

    // Callbacks from JavaScript
    void OnLeaderboardCallback(string json)
    {
        var response = JsonUtility.FromJson<LeaderboardResponse>(json);
        OnLeaderboardReceived?.Invoke(response);
    }

    void OnScoreCallback(string json)
    {
        var response = JsonUtility.FromJson<ScoreResponse>(json);
        OnScoreUploaded?.Invoke(response);
    }

    void OnLobbyCallback(string json)
    {
        var response = JsonUtility.FromJson<LobbyResponse>(json);
        OnLobbyJoined?.Invoke(response);
    }
}

// Response types
[Serializable]
public class LeaderboardResponse
{
    public bool success;
    public LeaderboardData data;
    public string message;
}

[Serializable]
public class LeaderboardData
{
    public string id;
    public string name;
    public int totalEntries;
}

[Serializable]
public class ScoreResponse
{
    public bool success;
    public string message;
}

[Serializable]
public class LobbyResponse
{
    public bool success;
    public string data; // Lobby ID
    public string message;
}
```

### Usage example

```csharp
using UnityEngine;

public class GameManager : MonoBehaviour
{
    void Start()
    {
        if (WavedashSDK.Instance.IsReady())
        {
            WavedashSDK.Instance.OnLeaderboardReceived += HandleLeaderboard;
            WavedashSDK.Instance.OnScoreUploaded += HandleScoreUploaded;

            WavedashSDK.Instance.GetLeaderboard("high-scores");
        }
    }

    void HandleLeaderboard(LeaderboardResponse response)
    {
        if (response.success)
        {
            Debug.Log($"Leaderboard: {response.data.name}");
        }
    }

    void HandleScoreUploaded(ScoreResponse response)
    {
        if (response.success)
        {
            Debug.Log("Score uploaded!");
        }
    }

    public void SubmitScore(int score)
    {
        WavedashSDK.Instance.UploadScore("j57abc...", score);
    }
}
```

## Testing locally

Run the development server:

```bash
wvdsh dev
```

## Building and publishing

### 1. Build your game

1. Open **File > Build Settings**
2. Select **WebGL**
3. Click **Build**
4. Save to your `upload_dir` folder

### 2. Push to Wavedash

```bash
wvdsh build push
```

## Troubleshooting

<AccordionGroup>
  <Accordion title="SDK not available">
    - Ensure you're running through `wvdsh dev` or on wavedash.com
    - Check browser console for JavaScript errors
    - Verify the .jslib file is in the correct location
  </Accordion>
  <Accordion title="Build too large">
    - Enable compression (Gzip or Brotli)
    - Strip unused engine code
    - Reduce texture sizes
    - Consider using Addressables for on-demand loading
  </Accordion>
  <Accordion title="Memory issues">
    - Increase WebGL memory size in Player Settings
    - Profile memory usage with browser dev tools
    - Optimize asset loading patterns
  </Accordion>
</AccordionGroup>

## Example project structure

```
my-unity-game/
├── Assets/
│   ├── Plugins/
│   │   └── WebGL/
│   │       └── WavedashPlugin.jslib
│   ├── Scripts/
│   │   ├── WavedashSDK.cs
│   │   └── GameManager.cs
│   └── Scenes/
│       └── Main.unity
├── Build/
│   └── WebGL/         # WebGL build output
├── ProjectSettings/
└── wavedash.toml
```
